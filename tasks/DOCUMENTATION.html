<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PrintKe Platform Documentation</title>
    <style>
        :root {
            --primary: #3b82f6;
            --primary-dark: #2563eb;
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-600: #4b5563;
            --gray-800: #1f2937;
            --gray-900: #111827;
            --green-100: #dcfce7;
            --green-800: #166534;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: var(--gray-800);
            background: var(--gray-50);
        }
        .container { max-width: 1200px; margin: 0 auto; padding: 40px 20px; }
        h1 { font-size: 2.5rem; color: var(--gray-900); margin-bottom: 1rem; }
        h2 { font-size: 1.75rem; color: var(--gray-900); margin: 2rem 0 1rem; padding-bottom: 0.5rem; border-bottom: 2px solid var(--primary); }
        h3 { font-size: 1.25rem; color: var(--gray-800); margin: 1.5rem 0 0.75rem; }
        p { margin-bottom: 1rem; color: var(--gray-600); }
        .header { text-align: center; margin-bottom: 3rem; }
        .header p { font-size: 1.25rem; }
        .card { background: white; border-radius: 12px; padding: 24px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); margin-bottom: 24px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; }
        .badge { display: inline-block; padding: 4px 12px; border-radius: 20px; font-size: 0.875rem; font-weight: 500; }
        .badge-primary { background: var(--primary); color: white; }
        .badge-success { background: var(--green-100); color: var(--green-800); }
        code { background: var(--gray-100); padding: 2px 6px; border-radius: 4px; font-family: monospace; font-size: 0.9em; }
        pre { background: var(--gray-900); color: #e5e7eb; padding: 16px; border-radius: 8px; overflow-x: auto; margin: 1rem 0; }
        pre code { background: none; padding: 0; color: inherit; }
        table { width: 100%; border-collapse: collapse; margin: 1rem 0; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid var(--gray-200); }
        th { background: var(--gray-100); font-weight: 600; }
        .tech-stack { display: flex; flex-wrap: wrap; gap: 8px; }
        .tech-tag { background: var(--gray-100); padding: 6px 12px; border-radius: 6px; font-size: 0.875rem; }
        ul { margin: 1rem 0 1rem 1.5rem; }
        li { margin-bottom: 0.5rem; color: var(--gray-600); }
        a { color: var(--primary); text-decoration: none; }
        a:hover { text-decoration: underline; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>PrintKe Platform Documentation</h1>
            <p>Card Printing Platform with Real-Time Delivery Tracking for Kenya</p>
            <div style="margin-top: 1rem;">
                <span class="badge badge-success">All Tests Passing</span>
                <span class="badge badge-primary">Production Ready</span>
            </div>
        </div>

        <h2>1. Overview</h2>
        <div class="card">
            <p>PrintKe is a complete card printing platform designed for the Kenyan market. It features:</p>
            <ul>
                <li>Customer-facing website for placing orders</li>
                <li>Admin dashboard for managing orders, drivers, and tracking deliveries</li>
                <li>Mobile driver app for real-time GPS tracking</li>
                <li>M-Pesa payment integration (mock mode available)</li>
                <li>Automatic PDF generation and printing (mock mode)</li>
            </ul>
        </div>

        <h2>2. GitHub Repositories</h2>
        <div class="grid">
            <div class="card">
                <h3>printke (API)</h3>
                <p><a href="https://github.com/silver-ring/printke">github.com/silver-ring/printke</a></p>
                <p>FastAPI backend with all microservices</p>
                <div class="tech-stack">
                    <span class="tech-tag">Python</span>
                    <span class="tech-tag">FastAPI</span>
                    <span class="tech-tag">SQLAlchemy</span>
                    <span class="tech-tag">WebSocket</span>
                </div>
            </div>
            <div class="card">
                <h3>printke-admin</h3>
                <p><a href="https://github.com/silver-ring/printke-admin">github.com/silver-ring/printke-admin</a></p>
                <p>Admin dashboard React application</p>
                <div class="tech-stack">
                    <span class="tech-tag">React</span>
                    <span class="tech-tag">TypeScript</span>
                    <span class="tech-tag">Vite</span>
                    <span class="tech-tag">Tailwind CSS</span>
                </div>
            </div>
            <div class="card">
                <h3>printke-driver</h3>
                <p><a href="https://github.com/silver-ring/printke-driver">github.com/silver-ring/printke-driver</a></p>
                <p>Driver mobile app for delivery tracking</p>
                <div class="tech-stack">
                    <span class="tech-tag">React Native</span>
                    <span class="tech-tag">Expo</span>
                    <span class="tech-tag">TypeScript</span>
                </div>
            </div>
            <div class="card">
                <h3>printke-infra</h3>
                <p><a href="https://github.com/silver-ring/printke-infra">github.com/silver-ring/printke-infra</a></p>
                <p>Docker Compose and infrastructure configs</p>
                <div class="tech-stack">
                    <span class="tech-tag">Docker</span>
                    <span class="tech-tag">Traefik</span>
                    <span class="tech-tag">PostgreSQL</span>
                    <span class="tech-tag">Redis</span>
                </div>
            </div>
        </div>

        <h2>3. API Endpoints</h2>
        <div class="card">
            <h3>Authentication</h3>
            <table>
                <tr><th>Method</th><th>Endpoint</th><th>Description</th></tr>
                <tr><td>POST</td><td>/api/admin/login</td><td>Admin login</td></tr>
                <tr><td>POST</td><td>/api/drivers/login</td><td>Driver login</td></tr>
            </table>
        </div>

        <div class="card">
            <h3>Orders</h3>
            <table>
                <tr><th>Method</th><th>Endpoint</th><th>Description</th></tr>
                <tr><td>POST</td><td>/api/orders/create</td><td>Create new order</td></tr>
                <tr><td>POST</td><td>/api/orders/calculate</td><td>Calculate pricing</td></tr>
                <tr><td>GET</td><td>/api/orders/{order_number}</td><td>Get order details</td></tr>
                <tr><td>GET</td><td>/api/orders/{order_number}/preview</td><td>Generate PDF preview</td></tr>
            </table>
        </div>

        <div class="card">
            <h3>Payments (M-Pesa)</h3>
            <table>
                <tr><th>Method</th><th>Endpoint</th><th>Description</th></tr>
                <tr><td>POST</td><td>/api/payments/mpesa/initiate</td><td>Initiate STK push</td></tr>
                <tr><td>GET</td><td>/api/payments/mpesa/status/{id}</td><td>Check payment status</td></tr>
                <tr><td>POST</td><td>/api/payments/mpesa/callback</td><td>M-Pesa callback</td></tr>
            </table>
        </div>

        <div class="card">
            <h3>Driver API</h3>
            <table>
                <tr><th>Method</th><th>Endpoint</th><th>Description</th></tr>
                <tr><td>GET</td><td>/api/drivers/me</td><td>Get current driver info</td></tr>
                <tr><td>GET</td><td>/api/drivers/deliveries</td><td>Get assigned deliveries</td></tr>
                <tr><td>POST</td><td>/api/drivers/deliveries/{id}/start</td><td>Start delivery</td></tr>
                <tr><td>POST</td><td>/api/drivers/deliveries/{id}/location</td><td>Update GPS location</td></tr>
                <tr><td>POST</td><td>/api/drivers/deliveries/{id}/complete</td><td>Complete delivery</td></tr>
            </table>
        </div>

        <div class="card">
            <h3>Admin API</h3>
            <table>
                <tr><th>Method</th><th>Endpoint</th><th>Description</th></tr>
                <tr><td>GET</td><td>/api/admin/dashboard</td><td>Dashboard statistics</td></tr>
                <tr><td>GET</td><td>/api/admin/orders</td><td>List all orders</td></tr>
                <tr><td>GET</td><td>/api/admin/drivers</td><td>List all drivers</td></tr>
                <tr><td>POST</td><td>/api/admin/drivers</td><td>Create driver</td></tr>
                <tr><td>PUT</td><td>/api/admin/drivers/{id}</td><td>Update driver</td></tr>
                <tr><td>DELETE</td><td>/api/admin/drivers/{id}</td><td>Delete driver</td></tr>
                <tr><td>POST</td><td>/api/admin/orders/{order}/assign</td><td>Assign to driver</td></tr>
                <tr><td>GET</td><td>/api/admin/active-deliveries</td><td>Get active deliveries</td></tr>
            </table>
        </div>

        <div class="card">
            <h3>WebSocket</h3>
            <table>
                <tr><th>Endpoint</th><th>Description</th></tr>
                <tr><td>ws://host/ws/deliveries</td><td>Real-time delivery location updates</td></tr>
            </table>
        </div>

        <h2>4. Running the System</h2>
        <div class="card">
            <h3>Development Mode</h3>
            <pre><code># Start the API
cd printke
source venv/bin/activate
uvicorn main:app --reload --host 0.0.0.0 --port 8000

# Start Admin Dashboard
cd printke-admin
npm install
npm run dev

# Start Driver App (requires Expo Go on phone)
cd printke-driver
npm install
npx expo start</code></pre>
        </div>

        <div class="card">
            <h3>Docker Production</h3>
            <pre><code># Start all services
cd printke-infra
docker-compose up -d

# View logs
docker-compose logs -f

# Stop services
docker-compose down</code></pre>
        </div>

        <h2>5. Pricing Tiers (KES)</h2>
        <div class="card">
            <table>
                <tr><th>Quantity</th><th>Price per Card</th></tr>
                <tr><td>1-10 cards</td><td>KES 400</td></tr>
                <tr><td>11-50 cards</td><td>KES 300</td></tr>
                <tr><td>51-200 cards</td><td>KES 200</td></tr>
                <tr><td>201-500 cards</td><td>KES 150</td></tr>
                <tr><td>501-1000 cards</td><td>KES 120</td></tr>
                <tr><td>1000+ cards</td><td>KES 100</td></tr>
            </table>
        </div>

        <h2>6. Delivery Fees</h2>
        <div class="card">
            <table>
                <tr><th>Location</th><th>Fee</th></tr>
                <tr><td>Nairobi CBD</td><td>KES 200</td></tr>
                <tr><td>Greater Nairobi</td><td>KES 300</td></tr>
                <tr><td>Thika</td><td>KES 350</td></tr>
                <tr><td>Nakuru</td><td>KES 500</td></tr>
                <tr><td>Eldoret</td><td>KES 600</td></tr>
                <tr><td>Mombasa/Kisumu</td><td>KES 700</td></tr>
                <tr><td>Other Counties</td><td>KES 1,000</td></tr>
            </table>
        </div>

        <h2>7. Test Results</h2>
        <div class="card">
            <h3>Main Flow Tests (9/9 Passed)</h3>
            <ul>
                <li>Health Check</li>
                <li>Pricing Calculation</li>
                <li>Order Creation</li>
                <li>Order Retrieval</li>
                <li>PDF Generation</li>
                <li>M-Pesa Payment (Mock)</li>
                <li>Order Status After Payment</li>
                <li>Admin Login</li>
                <li>Admin Dashboard</li>
            </ul>
        </div>

        <div class="card">
            <h3>Delivery Tracking Tests (12/12 Passed)</h3>
            <ul>
                <li>Admin Login</li>
                <li>Create Driver</li>
                <li>List Drivers</li>
                <li>Driver Login</li>
                <li>Assign Order to Driver</li>
                <li>Get Driver Deliveries</li>
                <li>Start Delivery</li>
                <li>Update Location (3 updates)</li>
                <li>Get Active Deliveries</li>
                <li>Complete Delivery</li>
                <li>Update Driver</li>
            </ul>
        </div>

        <h2>8. Default Credentials</h2>
        <div class="card">
            <p><strong>Admin Login:</strong></p>
            <ul>
                <li>Email: admin@printke.co.ke</li>
                <li>Password: admin123</li>
            </ul>
            <p><strong>Test Driver:</strong></p>
            <ul>
                <li>Phone: +254712345678</li>
                <li>Password: driver123</li>
            </ul>
        </div>

        <h2>9. Environment Variables</h2>
        <div class="card">
            <pre><code># Application
ENVIRONMENT=development
DEBUG=true
SECRET_KEY=your-super-secret-key

# Database
DATABASE_URL=sqlite+aiosqlite:///./printke.db

# M-Pesa (Sandbox)
MPESA_CONSUMER_KEY=your-key
MPESA_CONSUMER_SECRET=your-secret
MPESA_SHORTCODE=174379
MPESA_PASSKEY=your-passkey
MPESA_ENV=sandbox

# Printing
MOCK_PRINTING=true
PRINTER_NAME=LXM-Card-Printer</code></pre>
        </div>

        <div style="text-align: center; margin-top: 3rem; padding-top: 2rem; border-top: 1px solid var(--gray-200);">
            <p style="color: var(--gray-600);">PrintKe Platform - Built with FastAPI, React, and Expo</p>
            <p style="color: var(--gray-600);">Documentation generated: January 1, 2026</p>
        </div>
    </div>
</body>
</html>
